#!/usr/bin/perl

use strict;
use v5.10.0;

use File::Basename;
use constant DEBUG => 0;
use Term::ANSIColor qw(:constants);

sub printError {
  my $msg = shift;
  say BOLD, $msg, RESET if length($msg);
}

foreach my $file_onsite (@ARGV) { # no dev webroot checking, so could be any file.
  
    my $file_basename = basename($file_onsite);

    if (-f $file_onsite && -f $file_basename) {

      qx/cmp $file_onsite $file_basename/;

      if ($?) { # true if different files
	my $cmd = "diffharmony $file_onsite $file_basename";
	say $cmd if DEBUG;
	system($cmd);
      } else {
	printError("Skipping $file_onsite - no difference");
      }
    } else {
      printError("Skipping $file_onsite - both files not present");
    }

}
