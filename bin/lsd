#!/usr/bin/perl

# FIXME bug with the 'dots'

use strict;

my @dirs;
my $flag_ls_full_listing;

foreach (@ARGV) {
  if (-d $_) {
    push (@dirs, $_);
  } elsif ($_ eq '-l') {
    $flag_ls_full_listing = 1;
  }
}

if (! @dirs) {
  push (@dirs, '.');
}

foreach (@dirs) {

  chdir($_);
#  print "$_\n";

  my @dirs_to_display = split ("\n", `find -maxdepth 1 -type d`);

  if ($flag_ls_full_listing) {
    my $cmd_full_ls = "ls -l `@dirs_to_display`";
    system($cmd_full_ls);
  } else {
    foreach (@dirs_to_display) { print "$_\n"; }
  }
}
